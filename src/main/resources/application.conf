http-server-config{
    host = "0.0.0.0"
    host = ${?HTTP_SERVER_HOST}
    port = 8081
    port = ${?HTTP_SERVER_PORT}
}

mqtt-config{
    host = "localhost"
    host = ${?MQTT_BROKER_HOST}
    port = 1883
    port = ${?MQTT_BROKER_PORT}
    client-id = "smart-home-state"
    client-id = ${?MQTT_CLIENT_ID}
    keep-alive = 10
    clean-session = true
    trace-messages = false
    trace-messages = ${?MQTT_TRACE_MESSAGES}
}

ui-config{
    notifications-item = "NotificacionsSHS"
    default-repeat-interval = 1 hour
    open-hab-config{
        host = "localhost"
        host = ${?OPENHAB_HOST}
        port = 8080
        port = ${?OPENHAB_PORT}
        api-token = "changeme"
        api-token = ${?OPENHAB_API_TOKEN}
        retry-delay = 5 seconds
    }
}

power-production{
    power-production-source{
        polling-interval = 15 seconds
        fv-starting-hour = 6
        fv-ending-hour = 21
    }
    sunny-boy{
        username = "changeme"
        username = ${?SUNNYBOY_USERNAME}
        password = "changeme"
        password = ${?SUNNYBOY_PASSWORD}
        login-url = "http://192.168.2.115/dyn/login.json"
        login-url = ${?SUNNYBOY_LOGIN_URL}
        data-url = "http://192.168.2.115/dyn/getValues.json"
        data-url = ${?SUNNYBOY_DATA_URL}
        total-power-code = "6100_40263F00"
        frequency-code = "6100_00465700"
        lines-code = "6380_40251E00"
        serial-id = "0156-76BCE994"
        max-power-available = 3000.0
    }
}

state-persistence-config{
    path = "/app/data/state.json"
    path = ${?STATE_PERSISTENCE_PATH}
    store-period = 10 seconds
    store-period = ${?STATE_PERSISTENCE_INTERVAL}
}

processor {
    temperature-fans {
        id = "temperature-processor"
        online-status-item = "TemperaturesMicroControladorEstat"

        temperatures-items{
            # OpenHAB item names for temperature readings
            battery-temperature-item = "BateriesTemperaturaAdosadaSHS"
            battery-closet-temperature-item = "BateriesTemperaturaSHS"
            electronics-temperature-item = "ElectronicaTemperaturaSHS"
            external-temperature-item = "ExteriorArmarisTemperaturaSHS"
            goal-temperature-item = "TemperaturaObjectiuSHS"
            high-temperature-threshold = 35.0
            low-temperature-threshold = 0.0
            threshold-notification-period = 1 hour
        }
        fans{
            battery-fan {
                resend-interval = 15 seconds                
                # Fan control OpenHAB items
                battery-fan-status-item = "VentiladorBateriesStatusSHS"
                battery-fan-inconsistency-item = "VentiladorBateriesInconsistencySHS"
                battery-fan-command-item = "VentiladorBateriesSetSHS"
                # MQTT topics
                battery-fan-mqtt-topic = "fan/batteries/set"
                # Internal IDs for action tracking
                battery-fan-id = "ventilador-bateries"
            }
            electronics-fan {
                resend-interval = 15 seconds
                # Fan control OpenHAB items
                electronics-fan-status-item = "VentiladorElectronicaStatusSHS"
                electronics-fan-inconsistency-item = "VentiladorElectronicaInconsistencySHS"
                electronics-fan-command-item = "VentiladorElectronicaSetSHS"
                # MQTT topics
                electronics-fan-mqtt-topic = "fan/electronics/set"
                # Internal IDs for action tracking
                electronics-fan-id = "ventilador-electronica"
            }
        }      
    }
    
    offline-detector {
        timeout-duration = 2 minutes
        online-text = "En línia"
        offline-text = "Fora de línia"
    }

    sync-detector {
        timeout-duration = 45 seconds
        sync-text = "Sincronitzat"
        syncing-text = "Sincronitzant..."
        non-sync-text = "No sincronitzat"
    }

    heater {
        mqtt-topic-for-command = "arduino_calentador/potencia/set"
        status-item = "CalentadorStatusSHS"
        is-hot-item = "CalentadorCalentSHS"
        last-time-hot-item = "CalentadorUltimaVegadaCalentSHS"
        energy-today-item = "CalentadorEnergiaAvuiSHS"
        resend-interval = 20 seconds
        id = "heater-processor"
        online-status-item = "CalentadorMicroControladorEstatSHS"
        sync-status-item = "CalentadorSincronitzacioSHS"
        last-command-item = "CalentadorSetSHS"
        sync-timeout-for-dynamic-power = 1 minute
        dynamic-consumer-code = "CalentadorPrioritatConsumSHS"  #currently this has to be the OH Item holding the priority. When OH is removed this will be a unique code
    }

    infrared-stove {
        mqtt-topic-for-command = "estufa1/set"
        status-item = "EstufaInfrarrojosStatusSHS"
        energy-today-item = "EstufaInfrarrojosEnergiaAvuiSHS"
        resend-interval = 20 seconds
        id = "infrared-stove-processor"
        online-status-item = "EstufaInfrarrojosMicroControladorEstatSHS"
        sync-status-item = "EstufaInfrarrojosSincronitzacioSHS"
        last-command-item = "EstufaInfrarrojosSetSHS"
        last-change-item = "EstufaInfrarrojosUltimaConnexioSHS"
        sync-timeout-for-dynamic-power = 1 minute
        dynamic-consumer-code = "EstufaInfrarrojosPrioritatConsumSHS"  #currently this has to be the OH Item holding the priority. When OH is removed this will be a unique code
        programmed-off-time-item = "EstufaInfrarrojosProgramatApagamentSHS"
    }

    power{
        power-available{
            period-alarm-with-error = 5 minutes
            period-alarm-no-production = 20 hours
            power-available-item = "PotenciaDisponibleSHS"
            power-produced-item = "PotenciaGeneradaSHS"
            power-discarded-item = "PotenciaRebutjadaSHS"
            readings-status-item = "PotenciaEstatLecturesSHS"
        }
        dynamic-power{
            dynamic-fv-power-used-item = "PotenciaDinamicaFVSHS"
        }
    }

    feature-flags{
        heater-mqtt-topic = [${processor.heater.mqtt-topic-for-command}]   
        set-heater-management-item = "CalentadorHabilitatsSHS"
        infrared-stove-mqtt-topic = [${processor.infrared-stove.mqtt-topic-for-command}]
        set-infrared-stove-enabled-item = "EstufaInfrarrojosEnabledSHS"
    }
}
