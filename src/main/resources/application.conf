mqtt-config{
    host = "localhost"
    host = ${?MQTT_BROKER_HOST}
    port = 1883
    port = ${?MQTT_BROKER_PORT}
    client-id = "smart-home-state"
    client-id = ${?MQTT_CLIENT_ID}
    keep-alive = 10
    clean-session = true
    trace-messages = false
    trace-messages = ${?MQTT_TRACE_MESSAGES}
}

open-hab-config{
    host = "localhost"
    host = ${?OPENHAB_HOST}
    port = 8080
    port = ${?OPENHAB_PORT}
    api-token = ${?OPENHAB_API_TOKEN}
}

state-persistence-config{
    path = "/app/data/state.json"
    path = ${?STATE_PERSISTENCE_PATH}
    store-period = 10 seconds
    store-period = ${?STATE_PERSISTENCE_INTERVAL}
}

processor {
    temperature-fans {
        id = "temperature-processor"
        online-status-item = "TemperaturesMicroControladorEstat"

        temperatures-items{
            # OpenHAB item names for temperature readings
            battery-temperature-item = "BateriesTemperaturaAdosadaSHS"
            battery-closet-temperature-item = "BateriesTemperaturaSHS"
            electronics-temperature-item = "ElectronicaTemperaturaSHS"
            external-temperature-item = "ExteriorArmarisTemperaturaSHS"
            goal-temperature-item = "TemperaturaObjectiuSHS"
        }
        fans{
            resend-interval = 15 seconds
            timeout-interval = 1 minute
            
            # Fan control OpenHAB items
            battery-fan-status-item = "VentiladorBateriesStatusSHS"
            battery-fan-command-item = "VentiladorBateriesSetSHS"
            electronics-fan-status-item = "VentiladorElectronicaStatusSHS"
            electronics-fan-command-item = "VentiladorElectronicaSetSHS"
            fans-inconsistency-item = "VentiladorsInconsistencySHS"
            
            # MQTT topics
            battery-fan-mqtt-topic = "fan/batteries/set"
            electronics-fan-mqtt-topic = "fan/electronics/set"
            
            # Internal IDs for action tracking
            battery-fan-id = "ventilador-bateries"
            electronics-fan-id = "ventilador-electronica"
        }
        
    }
    
    offline-detector {
        timeout-duration = 2 minutes
        online-text = "En línia"
        offline-text = "Fora de línia"
    }

    sync-detector {
        timeout-duration = 45 seconds
        sync-text = "Sincronitzat"
        syncing-text = "Sincronitzant..."
        non-sync-text = "No sincronitzat"
    }

    heater {
        mqtt-topic-for-command = "arduino_calentador/potencia/set"
        status-item = "CalentadorStatusSHS"
        is-hot-item = "CalentadorCalentSHS"
        last-time-hot-item = "CalentadorUltimaVegadaCalentSHS"
        energy-today-item = "CalentadorEnergiaAvuiSHS"
        resend-interval = 20 seconds
        id = "heater-processor"
        online-status-item = "CalentadorMicroControladorEstatSHS"
        sync-status-item = "CalentadorSincronitzacioSHS"
        last-command-item = "CalentadorSetSHS"
    }
    feature-flags{
        temperatures-mqtt-topic = [${processor.temperature-related.battery-fan-mqtt-topic},${processor.temperature-related.electronics-fan-mqtt-topic}]
        set-fan-management-item = "VentiladorsHabilitatsSHS"
        heater-mqtt-topic = [${processor.heater.mqtt-topic-for-command}]   
        set-heater-management-item = "CalentadorHabilitatsSHS"
    }
}
